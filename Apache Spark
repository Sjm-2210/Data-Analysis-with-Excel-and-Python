{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/Sjm-2210/Data-Analysis-with-Excel-and-Python/blob/main/Apache%20Spark\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "yygFEGmbuTMb",
        "outputId": "f3e30be2-ae10-47e3-aba9-2868ce74b3a7"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Collecting openai\n",
            "  Downloading openai-1.30.5-py3-none-any.whl (320 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m320.7/320.7 kB\u001b[0m \u001b[31m3.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: anyio<5,>=3.5.0 in /usr/local/lib/python3.10/dist-packages (from openai) (3.7.1)\n",
            "Requirement already satisfied: distro<2,>=1.7.0 in /usr/lib/python3/dist-packages (from openai) (1.7.0)\n",
            "Collecting httpx<1,>=0.23.0 (from openai)\n",
            "  Downloading httpx-0.27.0-py3-none-any.whl (75 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m75.6/75.6 kB\u001b[0m \u001b[31m6.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: pydantic<3,>=1.9.0 in /usr/local/lib/python3.10/dist-packages (from openai) (2.7.1)\n",
            "Requirement already satisfied: sniffio in /usr/local/lib/python3.10/dist-packages (from openai) (1.3.1)\n",
            "Requirement already satisfied: tqdm>4 in /usr/local/lib/python3.10/dist-packages (from openai) (4.66.4)\n",
            "Requirement already satisfied: typing-extensions<5,>=4.7 in /usr/local/lib/python3.10/dist-packages (from openai) (4.11.0)\n",
            "Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai) (3.7)\n",
            "Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.5.0->openai) (1.2.1)\n",
            "Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from httpx<1,>=0.23.0->openai) (2024.2.2)\n",
            "Collecting httpcore==1.* (from httpx<1,>=0.23.0->openai)\n",
            "  Downloading httpcore-1.0.5-py3-none-any.whl (77 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m77.9/77.9 kB\u001b[0m \u001b[31m4.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hCollecting h11<0.15,>=0.13 (from httpcore==1.*->httpx<1,>=0.23.0->openai)\n",
            "  Downloading h11-0.14.0-py3-none-any.whl (58 kB)\n",
            "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m2.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hRequirement already satisfied: annotated-types>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic<3,>=1.9.0->openai) (0.7.0)\n",
            "Requirement already satisfied: pydantic-core==2.18.2 in /usr/local/lib/python3.10/dist-packages (from pydantic<3,>=1.9.0->openai) (2.18.2)\n",
            "Installing collected packages: h11, httpcore, httpx, openai\n",
            "Successfully installed h11-0.14.0 httpcore-1.0.5 httpx-0.27.0 openai-1.30.5\n"
          ]
        }
      ],
      "source": [
        "pip install openai\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "YPR_s3fT0h8S"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "QYmv9piR0ixQ"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Bm9D67g_0kTJ",
        "outputId": "b1ee533f-fe98-42a8-da16-d463ad79d0ff"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: pyspark in /usr/local/lib/python3.10/dist-packages (3.5.1)\n",
            "Requirement already satisfied: py4j==0.10.9.7 in /usr/local/lib/python3.10/dist-packages (from pyspark) (0.10.9.7)\n"
          ]
        }
      ],
      "source": [
        "pip install pyspark"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "wXcl5-sO1mpG"
      },
      "outputs": [],
      "source": [
        "from pyspark.sql import SparkSession"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 222
        },
        "id": "wb5ySbXp1uIl",
        "outputId": "83f815e5-115a-4d68-9596-dae913b4055d"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<pyspark.sql.session.SparkSession at 0x7da63a02c310>"
            ],
            "text/html": [
              "\n",
              "            <div>\n",
              "                <p><b>SparkSession - in-memory</b></p>\n",
              "                \n",
              "        <div>\n",
              "            <p><b>SparkContext</b></p>\n",
              "\n",
              "            <p><a href=\"http://4bdfca0a81ae:4040\">Spark UI</a></p>\n",
              "\n",
              "            <dl>\n",
              "              <dt>Version</dt>\n",
              "                <dd><code>v3.5.1</code></dd>\n",
              "              <dt>Master</dt>\n",
              "                <dd><code>local[*]</code></dd>\n",
              "              <dt>AppName</dt>\n",
              "                <dd><code>SparkByExamples.com</code></dd>\n",
              "            </dl>\n",
              "        </div>\n",
              "        \n",
              "            </div>\n",
              "        "
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "spark=SparkSession.builder.appName(\"SparkByExamples.com\").getOrCreate()\n",
        "spark"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "kosVY-Wh_oZT",
        "outputId": "b135a6b7-307e-420c-e5aa-6d8576b01c15"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+----+---------+---------+-----------+---------------+----------+--------+-----------+-----+---------+--------------------+----------+--------------+----------+-------------------+-------+-----------+----------+----+----+------------------+--------------------+--------+----------+-----+-----------+----------------+--------------+----------------------+----------------------+--------+-------+---------+----------+---------+-------------------+---------+-------------+-----------+---------------+---------------+-------------+------------------+----------+-----------------------+------------+---------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+----------------+---------+-------------------------+--------------+------------+-----------+-----------+-----------+-----------+-----------+------------------+------------+-------+-----------+-----------+----------+--------+----------------+------+-----------+------------+--------------------+-----------+--------------+-------+------------------------+-----------+------------------+--------------------+---------------------+--------------+--------+--------------------+------------------------+---------------------+------------------------------+---------------------+--------------+---------------+-----------+---------+---------+-------------+-------------+-------------------+--------+----------------+------------+------------------+------------------+--------------+----------------+--------------------+---------+---------------+-----------------+--------------+--------------------------+---------------+------------------------+----------------------+----------------+----------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+-------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+---------------+\n",
            "|  id|member_id|loan_amnt|funded_amnt|funded_amnt_inv|      term|int_rate|installment|grade|sub_grade|           emp_title|emp_length|home_ownership|annual_inc|verification_status|issue_d|loan_status|pymnt_plan| url|desc|           purpose|               title|zip_code|addr_state|  dti|delinq_2yrs|earliest_cr_line|inq_last_6mths|mths_since_last_delinq|mths_since_last_record|open_acc|pub_rec|revol_bal|revol_util|total_acc|initial_list_status|out_prncp|out_prncp_inv|total_pymnt|total_pymnt_inv|total_rec_prncp|total_rec_int|total_rec_late_fee|recoveries|collection_recovery_fee|last_pymnt_d|last_pymnt_amnt|next_pymnt_d|last_credit_pull_d|collections_12_mths_ex_med|mths_since_last_major_derog|policy_code|application_type|annual_inc_joint|dti_joint|verification_status_joint|acc_now_delinq|tot_coll_amt|tot_cur_bal|open_acc_6m|open_act_il|open_il_12m|open_il_24m|mths_since_rcnt_il|total_bal_il|il_util|open_rv_12m|open_rv_24m|max_bal_bc|all_util|total_rev_hi_lim|inq_fi|total_cu_tl|inq_last_12m|acc_open_past_24mths|avg_cur_bal|bc_open_to_buy|bc_util|chargeoff_within_12_mths|delinq_amnt|mo_sin_old_il_acct|mo_sin_old_rev_tl_op|mo_sin_rcnt_rev_tl_op|mo_sin_rcnt_tl|mort_acc|mths_since_recent_bc|mths_since_recent_bc_dlq|mths_since_recent_inq|mths_since_recent_revol_delinq|num_accts_ever_120_pd|num_actv_bc_tl|num_actv_rev_tl|num_bc_sats|num_bc_tl|num_il_tl|num_op_rev_tl|num_rev_accts|num_rev_tl_bal_gt_0|num_sats|num_tl_120dpd_2m|num_tl_30dpd|num_tl_90g_dpd_24m|num_tl_op_past_12m|pct_tl_nvr_dlq|percent_bc_gt_75|pub_rec_bankruptcies|tax_liens|tot_hi_cred_lim|total_bal_ex_mort|total_bc_limit|total_il_high_credit_limit|revol_bal_joint|sec_app_earliest_cr_line|sec_app_inq_last_6mths|sec_app_mort_acc|sec_app_open_acc|sec_app_revol_util|sec_app_open_act_il|sec_app_num_rev_accts|sec_app_chargeoff_within_12_mths|sec_app_collections_12_mths_ex_med|sec_app_mths_since_last_major_derog|hardship_flag|hardship_type|hardship_reason|hardship_status|deferral_term|hardship_amount|hardship_start_date|hardship_end_date|payment_plan_start_date|hardship_length|hardship_dpd|hardship_loan_status|orig_projected_additional_accrued_interest|hardship_payoff_balance_amount|hardship_last_payment_amount|disbursement_method|debt_settlement_flag|debt_settlement_flag_date|settlement_status|settlement_date|settlement_amount|settlement_percentage|settlement_term|\n",
            "+----+---------+---------+-----------+---------------+----------+--------+-----------+-----+---------+--------------------+----------+--------------+----------+-------------------+-------+-----------+----------+----+----+------------------+--------------------+--------+----------+-----+-----------+----------------+--------------+----------------------+----------------------+--------+-------+---------+----------+---------+-------------------+---------+-------------+-----------+---------------+---------------+-------------+------------------+----------+-----------------------+------------+---------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+----------------+---------+-------------------------+--------------+------------+-----------+-----------+-----------+-----------+-----------+------------------+------------+-------+-----------+-----------+----------+--------+----------------+------+-----------+------------+--------------------+-----------+--------------+-------+------------------------+-----------+------------------+--------------------+---------------------+--------------+--------+--------------------+------------------------+---------------------+------------------------------+---------------------+--------------+---------------+-----------+---------+---------+-------------+-------------+-------------------+--------+----------------+------------+------------------+------------------+--------------+----------------+--------------------+---------+---------------+-----------------+--------------+--------------------------+---------------+------------------------+----------------------+----------------+----------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+-------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+---------------+\n",
            "|NULL|     NULL|    10000|      10000|          10000| 36 months|  10.33%|     324.23|    B|       B1|                NULL|  < 1 year|      MORTGAGE|  280000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   974xx|        OR| 6.15|          2|          Jan-96|             0|                    18|                  NULL|      14|      0|     9082|       38%|       23|                  w|  9521.66|      9521.66|     639.85|         639.85|         478.34|       161.51|               0.0|         0|                      0|      Feb-19|         324.23|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|         671|     246828|          1|          3|          2|          3|                 1|       48552|     62|          1|          3|      4923|      46|           23900|     2|          7|           1|                   7|      17631|         11897|   43.1|                       0|          0|               158|                 275|                   11|             1|       1|                  11|                    NULL|                   11|                          NULL|                    0|             3|              4|          7|        7|       10|            9|           11|                  4|      14|               0|           0|                 0|                 4|          91.3|            28.6|                   0|        0|         367828|            61364|         20900|                     54912|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|          DirectPay|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     2500|       2500|           2500| 36 months|  13.56%|      84.92|    C|       C1|                Chef| 10+ years|          RENT|   55000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   109xx|        NY|18.24|          0|          Apr-01|             1|                  NULL|                    45|       9|      1|     4341|    10.30%|       34|                  w|  2386.02|      2386.02|     167.02|         167.02|         113.98|        53.04|               0.0|         0|                      0|      Feb-19|          84.92|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      16901|          2|          2|          1|          2|                 2|       12560|     69|          2|          7|      2137|      28|           42000|     1|         11|           2|                   9|       1878|         34360|    5.9|                       0|          0|               140|                 212|                    1|             1|       0|                   1|                    NULL|                    2|                          NULL|                    0|             2|              5|          3|        3|       16|            7|           18|                  5|       9|               0|           0|                 0|                 3|         100.0|             0.0|                   1|        0|          60124|            16901|         36500|                     18124|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    12000|      12000|          12000| 60 months|  13.56%|     276.49|    C|       C1|                NULL|  < 1 year|      MORTGAGE|   40000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   180xx|        PA|19.23|          0|          Aug-05|             2|                  NULL|                  NULL|       8|      0|    23195|    55.50%|        9|                  w| 11716.63|     11716.63|     539.42|         539.42|         283.37|       256.05|               0.0|         0|                      0|      Feb-19|         276.49|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      32462|          1|          1|          1|          1|                 4|        9267|    103|          2|          2|      9747|      64|           41800|     1|          0|           3|                   3|       4058|         16601|   54.9|                       0|          0|                 4|                 149|                    9|             4|       1|                  10|                    NULL|                    4|                          NULL|                    0|             5|              6|          5|        5|        1|            7|            7|                  6|       8|               0|           0|                 0|                 3|         100.0|            60.0|                   0|        0|          50800|            32462|         36800|                      9000|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    15000|      15000|          14975| 60 months|  14.47%|     352.69|    C|       C2|                NULL|       n/a|      MORTGAGE|   30000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   756xx|        TX| 41.6|          0|          Oct-99|             0|                  NULL|                  NULL|      20|      0|    20049|    37.20%|       30|                  f| 14654.57|     14630.15|     687.29|         686.14|         345.43|       341.86|               0.0|         0|                      0|      Feb-19|         352.69|      Apr-19|            Mar-19|                         0|                       NULL|          1|       Joint App|           55000|    34.95|          Source Verified|             0|           0|      65496|          1|          1|          0|          1|                16|        4458|     31|          1|          1|      3616|      36|           53900|     0|          2|           0|                   2|       3275|          2545|   74.3|                       0|          0|               149|                 230|                    6|             6|       1|                  31|                    NULL|                 NULL|                          NULL|                    0|             4|             13|          4|        5|        8|           18|           21|                 13|      20|               0|           0|                 0|                 1|         100.0|            50.0|                   0|        0|         118790|            24507|          9900|                     14490|          29704|                  Oct-99|                     0|               0|              16|              48.8|                  0|                   15|                               0|                                 0|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    16000|      16000|          16000| 60 months|  17.97%|     406.04|    D|       D1|Instructional Coo...|   5 years|      MORTGAGE|   51000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   284xx|        NC|21.91|          0|          Oct-05|             1|                    52|                  NULL|      11|      0|     7326|    24.80%|       27|                  w| 15664.63|     15664.63|     788.12|         788.12|         335.37|       452.75|               0.0|         0|                      0|      Feb-19|         406.04|      Apr-19|            Mar-19|                         0|                         52|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      39339|          3|          8|          2|          2|                 2|       32013|     83|          1|          1|      3881|      58|           29500|     0|          0|           1|                   3|       3576|         22174|   24.8|                       0|          0|               123|                 158|                    6|             2|       0|                   6|                      52|                    4|                            52|                    6|             2|              2|          3|        6|       21|            3|            6|                  2|      11|               0|           0|                 0|                 3|          77.8|             0.0|                   0|        0|          67924|            39339|         29500|                     38424|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     9600|       9600|           9600| 36 months|  23.40%|     373.62|    E|       E1| driver coordinator |   9 years|          RENT|   65000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|       credit_card|Credit card refin...|   265xx|        WV|23.01|          1|          Sep-03|             0|                    16|                  NULL|      12|      0|    10678|    37.50%|       20|                  f|  9223.52|      9223.52|     728.52|         728.52|         376.48|       352.04|               0.0|         0|                      0|      Feb-19|         373.62|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|          66|      24165|          0|          2|          0|          0|                43|       13487|     33|          1|          1|      2264|      35|           28500|     0|          0|           0|                   1|       2014|           232|   96.9|                       0|          0|               183|                  92|                   12|            12|       0|                  27|                    NULL|                   15|                            30|                    0|             7|              9|          7|        8|        8|           10|           12|                  9|      12|               0|           0|                 0|                 1|          90.0|            85.7|                   0|        0|          68902|            24165|          7600|                     40402|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     4000|       4000|           4000| 36 months|  23.40%|     155.68|    E|       E1|            Security|   3 years|          RENT|   90000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   070xx|        NJ|26.33|          0|          Sep-06|             4|                    59|                  NULL|      15|      0|     5199|    19.20%|       20|                  w|  3843.13|      3843.13|     303.56|         303.56|         156.87|       146.69|               0.0|         0|                      0|      Feb-19|         155.68|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      66926|          5|          4|          3|          4|                 5|       61727|     86|          6|         11|      1353|      68|           27100|     4|          0|           4|                  15|       4462|         20174|    7.9|                       0|          0|               147|                 118|                    2|             2|       0|                   2|                    NULL|                    0|                          NULL|                    0|             5|              7|          9|        9|        8|           11|           12|                  7|      15|               0|           0|                 0|                 9|          95.0|             0.0|                   0|        0|          98655|            66926|         21900|                     71555|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     3500|       3500|           3500| 36 months|  20.89%|     131.67|    D|       D4|       gas attendant| 10+ years|      MORTGAGE|   40000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|               car|       Car financing|   078xx|        NJ| 9.09|          0|          Oct-04|             1|                    24|                  NULL|       4|      0|     1944|    33.50%|       18|                  w|  3357.29|      3357.29|     257.25|         257.25|         142.71|       114.54|               0.0|         0|                      0|      Feb-19|         131.67|      Apr-19|            Mar-19|                         0|                         48|          1|       Joint App|           59500|    10.59|          Source Verified|             0|           0|     189794|          1|          1|          1|          1|                 7|       24958|    100|          2|          2|      1317|      87|            5800|     1|          0|           3|                   3|      47449|          3683|   26.3|                       0|          0|               150|                 170|                    1|             1|       4|                   8|                      48|                    1|                            48|                    2|             1|              2|          1|        8|        3|            2|           11|                  2|       4|               0|           0|                 0|                 3|          38.9|             0.0|                   0|        0|         217000|            26902|          5000|                     25000|           6902|                  May-03|                     0|               3|               6|              47.9|                  0|                   21|                               0|                                 0|                                 46|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     9600|       9600|           9600| 36 months|  12.98%|     323.37|    B|       B5|                NULL|       n/a|      MORTGAGE|   35704.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|  home_improvement|    Home improvement|   401xx|        KY| 0.84|          0|          Nov-03|             0|                    69|                  NULL|       5|      0|      748|    11.50%|       23|                  w|  9158.56|      9158.56|     670.98|         670.98|         441.44|       229.54|               0.0|         0|                      0|      Mar-19|         323.37|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|        748|          0|          0|          0|          0|                44|           0|   NULL|          0|          3|       748|      12|            6500|     0|          0|           1|                   3|        150|          3452|   17.8|                       0|          0|               181|                 100|                   13|            13|       0|                  16|                    NULL|                    3|                          NULL|                    0|             1|              1|          2|        2|       16|            5|            7|                  1|       5|               0|           0|                 0|                 0|          95.5|             0.0|                   0|        0|           6500|              748|          4200|                         0|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     8000|       8000|           8000| 36 months|  23.40%|     311.35|    E|       E1|             Manager| 10+ years|           OWN|   43000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   357xx|        AL|33.24|          0|          Jan-95|             0|                  NULL|                   107|       8|      1|     9019|    81.30%|       16|                  w|  7686.27|      7686.27|      607.1|          607.1|         313.73|       293.37|               0.0|         0|                      0|      Feb-19|         311.35|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|     169223|          0|          3|          2|          2|                 7|       22059|     69|          0|          0|      2174|      72|           11100|     1|          1|           1|                   2|      21153|           126|   94.5|                       0|          0|               148|                 287|                   44|             7|       1|                  51|                    NULL|                    7|                          NULL|                    0|             1|              4|          1|        2|        8|            4|            7|                  4|       8|               0|           0|                 0|                 2|         100.0|           100.0|                   1|        0|         199744|            31078|          2300|                     32206|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    16000|      16000|          16000| 60 months|  26.31%|     481.99|    E|       E4|Financial Relatio...|  < 1 year|          RENT|   33000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|       credit_card|Credit card refin...|   290xx|        SC|33.62|          0|          Sep-10|             1|                  NULL|                  NULL|      17|      0|    22872|    65.50%|       22|                  w| 15734.74|     15734.74|      928.9|          928.9|         265.26|       663.64|               0.0|         0|                      0|      Feb-19|         481.99|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      29869|          1|          1|          0|          1|                24|        6997|     65|          1|          1|      2703|      65|           34900|     0|          3|           1|                   2|       1757|          4596|   66.9|                       0|          0|                29|                  99|                    2|             2|       0|                   2|                    NULL|                    3|                          NULL|                    0|             6|             11|          9|       13|        2|           16|           20|                 11|      17|               0|           0|                 0|                 1|         100.0|            55.6|                   0|        0|          45709|            29869|         13900|                     10809|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    30000|      30000|          30000| 60 months|  18.94%|     777.23|    D|       D2|         Postmaster | 10+ years|      MORTGAGE|   90000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   713xx|        LA|26.52|          0|          Jun-87|             0|                    71|                    75|      13|      1|    12315|    24.20%|       44|                  w| 29387.75|     29387.75|    1507.11|        1507.11|         612.25|       894.86|               0.0|         0|                      0|      Feb-19|         777.23|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|        1208|     321915|          4|          4|          2|          3|                 3|       87153|     88|          4|          5|       998|      57|           50800|     2|         15|           2|                  10|      24763|         13761|    8.3|                       0|          0|               163|                 378|                    4|             3|       3|                   4|                    NULL|                    4|                          NULL|                    0|             2|              4|          4|        9|       27|            8|           14|                  4|      13|               0|           0|                 0|                 6|          95.0|             0.0|                   1|        0|         372872|            99468|         15000|                     94072|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    10000|      10000|          10000| 60 months|  19.92%|      264.5|    D|       D3|    Material Handler| 10+ years|      MORTGAGE|   80000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   648xx|        MO|20.67|          0|          Apr-05|             0|                    37|                  NULL|      11|      0|    13198|    73.70%|       19|                  w|  9801.36|      9801.36|      512.4|          512.4|         198.64|       313.76|               0.0|         0|                      0|      Feb-19|          264.5|      Apr-19|            Mar-19|                         0|                         37|          1|      Individual|            NULL|     NULL|                     NULL|             0|         116|     110120|          0|          2|          0|          1|                15|       24408|     70|          1|          1|      6521|      72|           17900|     0|          0|           1|                   2|      10011|           779|   90.3|                       0|          0|               148|                 164|                   11|            11|       1|                 149|                      37|                   11|                            37|                    0|             2|              8|          2|        4|        6|            8|           12|                  8|      11|               0|           0|                 0|                 1|          84.2|            50.0|                   0|        0|         170230|            37606|          8000|                     55030|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     5000|       5000|           5000| 36 months|  17.97%|     180.69|    D|       D1|      Administrative|   6 years|      MORTGAGE|   59280.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   490xx|        MI|10.51|          0|          Apr-11|             0|                  NULL|                  NULL|       8|      0|     4599|    19.10%|       13|                  w|  4787.21|      4787.21|     353.89|         353.89|         212.79|        141.1|               0.0|         0|                      0|      Feb-19|         180.69|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|     110299|          0|          1|          0|          2|                14|        7150|     72|          0|          2|         0|      35|           24100|     1|          5|           0|                   4|      18383|         13800|    0.0|                       0|          0|                87|                  92|                   15|            14|       2|                  77|                    NULL|                   14|                          NULL|                    0|             0|              3|          3|        3|        4|            6|            7|                  3|       8|               0|           0|                 0|                 0|         100.0|             0.0|                   0|        0|         136927|            11749|         13800|                     10000|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    23000|      23000|          23000| 60 months|  20.89%|     620.81|    D|       D4|            Operator|   5 years|          RENT|   68107.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   672xx|        KS| 0.52|          0|          Feb-97|             0|                  NULL|                  NULL|       5|      0|      976|       13%|       10|                  w| 22553.51|     22553.51|     1203.4|         1203.4|         446.49|       756.91|               0.0|         0|                      0|      Mar-19|         622.63|      Apr-19|            Mar-19|                         1|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|        2693|        976|          0|          0|          0|          0|                36|           0|   NULL|          3|          4|         0|      13|            7500|     2|          2|           4|                   4|        195|          3300|    0.0|                       0|          0|               237|                 262|                   10|            10|       0|                  10|                    NULL|                    9|                          NULL|                    0|             0|              1|          3|        4|        3|            5|            7|                  1|       5|               0|           0|                 0|                 3|         100.0|             0.0|                   0|        0|           7500|              976|          3300|                         0|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    32075|      32075|          32075| 60 months|  11.80%|     710.26|    B|       B4|  Nursing Supervisor| 10+ years|      MORTGAGE|  150000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|       credit_card|Credit card refin...|   231xx|        VA|22.21|          0|          Aug-05|             0|                  NULL|                  NULL|      17|      0|    19077|       32%|       24|                  w| 31281.41|     31281.41|    1388.98|        1388.98|         793.59|       595.39|               0.0|         0|                      0|      Feb-19|         710.26|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|     272667|          1|          4|          1|          1|                 9|       37558|     47|          1|          1|      3910|      41|           59600|     1|          2|           0|                   3|      16039|         10446|   47.8|                       0|          0|               160|                  70|                    4|             4|       2|                  27|                    NULL|                   14|                          NULL|                    0|             4|             10|          4|        4|        8|           12|           14|                 10|      17|               0|           0|                 0|                 2|         100.0|            50.0|                   0|        0|         360433|            56635|         20000|                     80125|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    13000|      13000|          13000| 36 months|  23.40%|     505.95|    E|       E1| Sale Representative|   2 years|      MORTGAGE|   90000.0|           Verified| Dec-18|    Current|         n|NULL|NULL|             other|               Other|   191xx|        PA|39.73|          0|          May-07|             0|                  NULL|                  NULL|      14|      0|    52013|    83.10%|       20|                  w| 12490.18|     12490.18|     986.55|         986.55|         509.82|       476.73|               0.0|         0|                      0|      Feb-19|         505.95|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      87876|          1|          7|          1|          3|                 1|       35863|     48|          0|          1|     18037|      64|           62600|     2|          0|           1|                   4|       6277|          9503|   83.8|                       0|          0|               131|                 139|                   16|             1|       0|                  16|                    NULL|                   10|                          NULL|                    0|             6|              7|          6|        7|       11|            7|            9|                  7|      14|               0|           0|                 0|                 1|         100.0|            66.7|                   0|        0|         137276|            87876|         58600|                     74676|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               Cash|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    35000|      35000|          35000| 60 months|  15.02%|     833.02|    C|       C3|    Sr Sales Manager| 10+ years|      MORTGAGE|  290000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   656xx|        MO|  7.6|          0|          Dec-04|             0|                    29|                  NULL|      15|      0|    29416|    93.70%|       33|                  w| 34205.18|     34205.18|    1622.23|        1622.23|         794.82|       827.41|               0.0|         0|                      0|      Feb-19|         833.02|      Apr-19|            Mar-19|                         1|                         42|          1|      Individual|            NULL|     NULL|                     NULL|             0|         149|     479986|          1|          8|          0|          2|                17|       58023|     58|          0|          1|     12297|      75|           31400|     0|          0|           2|                   4|      31999|          1038|   95.2|                       0|          0|               168|                 167|                   22|             6|       3|                  22|                      42|                    8|                            29|                    0|             3|              4|          3|        8|       17|            6|           13|                  4|      15|               0|           0|                 0|                 1|          87.9|           100.0|                   0|        0|         513173|            87439|         21600|                     82773|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|          DirectPay|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|    40000|      40000|          40000| 60 months|  11.31%|      875.9|    B|       B3|                NULL|  < 1 year|      MORTGAGE|  136000.0|       Not Verified| Dec-18|    Current|         n|NULL|NULL|debt_consolidation|  Debt consolidation|   480xx|        MI|15.41|          0|          Apr-06|             0|                    72|                  NULL|      12|      0|    34283|       81%|       22|                  w|  38997.5|      38997.5|     1714.1|         1714.1|         1002.5|        711.6|               0.0|         0|                      0|      Feb-19|          875.9|      Apr-19|            Mar-19|                         0|                       NULL|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|     149597|          1|          2|          0|          1|                14|       27860|     66|          2|          2|      9618|      73|           42300|     0|          0|           0|                   3|      12466|          2589|   89.6|                       0|          0|               123|                 132|                    1|             1|       3|                  40|                    NULL|                   15|                          NULL|                    0|             3|              8|          4|        8|        5|            9|           14|                  8|      12|               0|           0|                 0|                 2|          86.4|            75.0|                   0|        0|         179159|            62143|         25000|                     42409|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|          DirectPay|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "|NULL|     NULL|     8000|       8000|           8000| 36 months|  10.33%|     259.38|    B|       B1|            Optician|   6 years|      MORTGAGE|   38000.0|    Source Verified| Dec-18|    Current|         n|NULL|NULL|       credit_card|Credit card refin...|   159xx|        PA|19.84|          0|          Feb-03|             1|                    49|                  NULL|      14|      0|     9394|    37.60%|       25|                  w|  7617.33|      7617.33|     511.87|         511.87|         382.67|        129.2|               0.0|         0|                      0|      Feb-19|         259.38|      Apr-19|            Mar-19|                         0|                         52|          1|      Individual|            NULL|     NULL|                     NULL|             0|           0|      83139|          4|          1|          2|          2|                 5|       22240|     95|          4|          5|      6410|      65|           25000|     2|          0|           8|                   8|       5939|          6188|   57.6|                       0|          0|               167|                 133|                    1|             1|       3|                   2|                    NULL|                    1|                          NULL|                    1|             4|              8|          4|        6|        6|           12|           16|                  8|      14|               0|           0|                 0|                 7|          95.7|            25.0|                   0|        0|         100250|            31634|         14600|                     23358|           NULL|                    NULL|                  NULL|            NULL|            NULL|              NULL|               NULL|                 NULL|                            NULL|                              NULL|                               NULL|            N|         NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|          DirectPay|                   N|                     NULL|             NULL|           NULL|             NULL|                 NULL|           NULL|\n",
            "+----+---------+---------+-----------+---------------+----------+--------+-----------+-----+---------+--------------------+----------+--------------+----------+-------------------+-------+-----------+----------+----+----+------------------+--------------------+--------+----------+-----+-----------+----------------+--------------+----------------------+----------------------+--------+-------+---------+----------+---------+-------------------+---------+-------------+-----------+---------------+---------------+-------------+------------------+----------+-----------------------+------------+---------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+----------------+---------+-------------------------+--------------+------------+-----------+-----------+-----------+-----------+-----------+------------------+------------+-------+-----------+-----------+----------+--------+----------------+------+-----------+------------+--------------------+-----------+--------------+-------+------------------------+-----------+------------------+--------------------+---------------------+--------------+--------+--------------------+------------------------+---------------------+------------------------------+---------------------+--------------+---------------+-----------+---------+---------+-------------+-------------+-------------------+--------+----------------+------------+------------------+------------------+--------------+----------------+--------------------+---------+---------------+-----------------+--------------+--------------------------+---------------+------------------------+----------------------+----------------+----------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+-------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+---------------+\n",
            "only showing top 20 rows\n",
            "\n"
          ]
        }
      ],
      "source": [
        "file_location=\"/content/LoanStats.csv\"\n",
        "file_type=\"csv\"\n",
        "infer_schema=\"true\"\n",
        "first_row_is_header=\"true\"\n",
        "df=spark.read.format(file_type).option(\"inferSchema\",infer_schema).option(\"header\",first_row_is_header).load(file_location)\n",
        "df.show()\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "UdQ80ukoG114",
        "outputId": "c3d2f926-769a-4ca6-e234-2c11ad5c05d9"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "4101"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ],
      "source": [
        "df.count()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "KHQWjzKlbhuO",
        "outputId": "2b1daca4-2ced-42f6-86df-96999fdb9cbe"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "root\n",
            " |-- id: string (nullable = true)\n",
            " |-- member_id: string (nullable = true)\n",
            " |-- loan_amnt: integer (nullable = true)\n",
            " |-- funded_amnt: integer (nullable = true)\n",
            " |-- funded_amnt_inv: integer (nullable = true)\n",
            " |-- term: string (nullable = true)\n",
            " |-- int_rate: string (nullable = true)\n",
            " |-- installment: double (nullable = true)\n",
            " |-- grade: string (nullable = true)\n",
            " |-- sub_grade: string (nullable = true)\n",
            " |-- emp_title: string (nullable = true)\n",
            " |-- emp_length: string (nullable = true)\n",
            " |-- home_ownership: string (nullable = true)\n",
            " |-- annual_inc: double (nullable = true)\n",
            " |-- verification_status: string (nullable = true)\n",
            " |-- issue_d: string (nullable = true)\n",
            " |-- loan_status: string (nullable = true)\n",
            " |-- pymnt_plan: string (nullable = true)\n",
            " |-- url: string (nullable = true)\n",
            " |-- desc: string (nullable = true)\n",
            " |-- purpose: string (nullable = true)\n",
            " |-- title: string (nullable = true)\n",
            " |-- zip_code: string (nullable = true)\n",
            " |-- addr_state: string (nullable = true)\n",
            " |-- dti: double (nullable = true)\n",
            " |-- delinq_2yrs: integer (nullable = true)\n",
            " |-- earliest_cr_line: string (nullable = true)\n",
            " |-- inq_last_6mths: integer (nullable = true)\n",
            " |-- mths_since_last_delinq: integer (nullable = true)\n",
            " |-- mths_since_last_record: integer (nullable = true)\n",
            " |-- open_acc: integer (nullable = true)\n",
            " |-- pub_rec: integer (nullable = true)\n",
            " |-- revol_bal: integer (nullable = true)\n",
            " |-- revol_util: string (nullable = true)\n",
            " |-- total_acc: integer (nullable = true)\n",
            " |-- initial_list_status: string (nullable = true)\n",
            " |-- out_prncp: double (nullable = true)\n",
            " |-- out_prncp_inv: double (nullable = true)\n",
            " |-- total_pymnt: double (nullable = true)\n",
            " |-- total_pymnt_inv: double (nullable = true)\n",
            " |-- total_rec_prncp: double (nullable = true)\n",
            " |-- total_rec_int: double (nullable = true)\n",
            " |-- total_rec_late_fee: double (nullable = true)\n",
            " |-- recoveries: integer (nullable = true)\n",
            " |-- collection_recovery_fee: integer (nullable = true)\n",
            " |-- last_pymnt_d: string (nullable = true)\n",
            " |-- last_pymnt_amnt: double (nullable = true)\n",
            " |-- next_pymnt_d: string (nullable = true)\n",
            " |-- last_credit_pull_d: string (nullable = true)\n",
            " |-- collections_12_mths_ex_med: integer (nullable = true)\n",
            " |-- mths_since_last_major_derog: integer (nullable = true)\n",
            " |-- policy_code: integer (nullable = true)\n",
            " |-- application_type: string (nullable = true)\n",
            " |-- annual_inc_joint: integer (nullable = true)\n",
            " |-- dti_joint: double (nullable = true)\n",
            " |-- verification_status_joint: string (nullable = true)\n",
            " |-- acc_now_delinq: integer (nullable = true)\n",
            " |-- tot_coll_amt: integer (nullable = true)\n",
            " |-- tot_cur_bal: integer (nullable = true)\n",
            " |-- open_acc_6m: integer (nullable = true)\n",
            " |-- open_act_il: integer (nullable = true)\n",
            " |-- open_il_12m: integer (nullable = true)\n",
            " |-- open_il_24m: integer (nullable = true)\n",
            " |-- mths_since_rcnt_il: integer (nullable = true)\n",
            " |-- total_bal_il: integer (nullable = true)\n",
            " |-- il_util: integer (nullable = true)\n",
            " |-- open_rv_12m: integer (nullable = true)\n",
            " |-- open_rv_24m: integer (nullable = true)\n",
            " |-- max_bal_bc: integer (nullable = true)\n",
            " |-- all_util: integer (nullable = true)\n",
            " |-- total_rev_hi_lim: integer (nullable = true)\n",
            " |-- inq_fi: integer (nullable = true)\n",
            " |-- total_cu_tl: integer (nullable = true)\n",
            " |-- inq_last_12m: integer (nullable = true)\n",
            " |-- acc_open_past_24mths: integer (nullable = true)\n",
            " |-- avg_cur_bal: integer (nullable = true)\n",
            " |-- bc_open_to_buy: integer (nullable = true)\n",
            " |-- bc_util: double (nullable = true)\n",
            " |-- chargeoff_within_12_mths: integer (nullable = true)\n",
            " |-- delinq_amnt: integer (nullable = true)\n",
            " |-- mo_sin_old_il_acct: integer (nullable = true)\n",
            " |-- mo_sin_old_rev_tl_op: integer (nullable = true)\n",
            " |-- mo_sin_rcnt_rev_tl_op: integer (nullable = true)\n",
            " |-- mo_sin_rcnt_tl: integer (nullable = true)\n",
            " |-- mort_acc: integer (nullable = true)\n",
            " |-- mths_since_recent_bc: integer (nullable = true)\n",
            " |-- mths_since_recent_bc_dlq: integer (nullable = true)\n",
            " |-- mths_since_recent_inq: integer (nullable = true)\n",
            " |-- mths_since_recent_revol_delinq: integer (nullable = true)\n",
            " |-- num_accts_ever_120_pd: integer (nullable = true)\n",
            " |-- num_actv_bc_tl: integer (nullable = true)\n",
            " |-- num_actv_rev_tl: integer (nullable = true)\n",
            " |-- num_bc_sats: integer (nullable = true)\n",
            " |-- num_bc_tl: integer (nullable = true)\n",
            " |-- num_il_tl: integer (nullable = true)\n",
            " |-- num_op_rev_tl: integer (nullable = true)\n",
            " |-- num_rev_accts: integer (nullable = true)\n",
            " |-- num_rev_tl_bal_gt_0: integer (nullable = true)\n",
            " |-- num_sats: integer (nullable = true)\n",
            " |-- num_tl_120dpd_2m: integer (nullable = true)\n",
            " |-- num_tl_30dpd: integer (nullable = true)\n",
            " |-- num_tl_90g_dpd_24m: integer (nullable = true)\n",
            " |-- num_tl_op_past_12m: integer (nullable = true)\n",
            " |-- pct_tl_nvr_dlq: double (nullable = true)\n",
            " |-- percent_bc_gt_75: double (nullable = true)\n",
            " |-- pub_rec_bankruptcies: integer (nullable = true)\n",
            " |-- tax_liens: integer (nullable = true)\n",
            " |-- tot_hi_cred_lim: integer (nullable = true)\n",
            " |-- total_bal_ex_mort: integer (nullable = true)\n",
            " |-- total_bc_limit: integer (nullable = true)\n",
            " |-- total_il_high_credit_limit: integer (nullable = true)\n",
            " |-- revol_bal_joint: integer (nullable = true)\n",
            " |-- sec_app_earliest_cr_line: string (nullable = true)\n",
            " |-- sec_app_inq_last_6mths: integer (nullable = true)\n",
            " |-- sec_app_mort_acc: integer (nullable = true)\n",
            " |-- sec_app_open_acc: integer (nullable = true)\n",
            " |-- sec_app_revol_util: double (nullable = true)\n",
            " |-- sec_app_open_act_il: integer (nullable = true)\n",
            " |-- sec_app_num_rev_accts: integer (nullable = true)\n",
            " |-- sec_app_chargeoff_within_12_mths: integer (nullable = true)\n",
            " |-- sec_app_collections_12_mths_ex_med: integer (nullable = true)\n",
            " |-- sec_app_mths_since_last_major_derog: integer (nullable = true)\n",
            " |-- hardship_flag: string (nullable = true)\n",
            " |-- hardship_type: string (nullable = true)\n",
            " |-- hardship_reason: string (nullable = true)\n",
            " |-- hardship_status: string (nullable = true)\n",
            " |-- deferral_term: string (nullable = true)\n",
            " |-- hardship_amount: string (nullable = true)\n",
            " |-- hardship_start_date: string (nullable = true)\n",
            " |-- hardship_end_date: string (nullable = true)\n",
            " |-- payment_plan_start_date: string (nullable = true)\n",
            " |-- hardship_length: string (nullable = true)\n",
            " |-- hardship_dpd: string (nullable = true)\n",
            " |-- hardship_loan_status: string (nullable = true)\n",
            " |-- orig_projected_additional_accrued_interest: string (nullable = true)\n",
            " |-- hardship_payoff_balance_amount: string (nullable = true)\n",
            " |-- hardship_last_payment_amount: string (nullable = true)\n",
            " |-- disbursement_method: string (nullable = true)\n",
            " |-- debt_settlement_flag: string (nullable = true)\n",
            " |-- debt_settlement_flag_date: string (nullable = true)\n",
            " |-- settlement_status: string (nullable = true)\n",
            " |-- settlement_date: string (nullable = true)\n",
            " |-- settlement_amount: string (nullable = true)\n",
            " |-- settlement_percentage: string (nullable = true)\n",
            " |-- settlement_term: string (nullable = true)\n",
            "\n"
          ]
        }
      ],
      "source": [
        "df.printSchema()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "id": "TrcwA_Y2e3Mt",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "60566491-50ff-40fb-a2e5-9ebbe42d10e1"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "UsageError: Line magic function `%sql` not found.\n"
          ]
        }
      ],
      "source": [
        "temp_table_name=\"loanstats\"\n",
        "df.createOrReplaceTempView(temp_table_name)\n",
        "%sql select * from loanstats\n"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df.describe().show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "HxMvaaDGkTjD",
        "outputId": "dd759d2a-bb5b-4ab7-c7e6-7ab738f478e7"
      },
      "execution_count": 54,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+-------+--------------------+---------+------------------+------------------+------------------+----------+--------+------------------+------+---------+------------------+----------+--------------+------------------+-------------------+-------+------------------+----------+----+----+--------+--------+--------+----------+------------------+-------------------+----------------+-------------------+----------------------+----------------------+-----------------+-------------------+------------------+----------+------------------+-------------------+------------------+------------------+-----------------+------------------+------------------+-----------------+-------------------+--------------------+-----------------------+------------+-----------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+------------------+------------------+-------------------------+--------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+--------------------+-----------------+------------------+------------------+------------------------+------------------+------------------+--------------------+---------------------+-----------------+------------------+--------------------+------------------------+---------------------+------------------------------+---------------------+------------------+-----------------+------------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------------+----------------+------------+--------------------+------------------+-----------------+------------------+--------------------+---------+------------------+-----------------+------------------+--------------------------+------------------+------------------------+----------------------+------------------+------------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+--------------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+-----------------+\n",
            "|summary|                  id|member_id|         loan_amnt|       funded_amnt|   funded_amnt_inv|      term|int_rate|       installment| grade|sub_grade|         emp_title|emp_length|home_ownership|        annual_inc|verification_status|issue_d|       loan_status|pymnt_plan| url|desc| purpose|   title|zip_code|addr_state|               dti|        delinq_2yrs|earliest_cr_line|     inq_last_6mths|mths_since_last_delinq|mths_since_last_record|         open_acc|            pub_rec|         revol_bal|revol_util|         total_acc|initial_list_status|         out_prncp|     out_prncp_inv|      total_pymnt|   total_pymnt_inv|   total_rec_prncp|    total_rec_int| total_rec_late_fee|          recoveries|collection_recovery_fee|last_pymnt_d|  last_pymnt_amnt|next_pymnt_d|last_credit_pull_d|collections_12_mths_ex_med|mths_since_last_major_derog|policy_code|application_type|  annual_inc_joint|         dti_joint|verification_status_joint|acc_now_delinq|      tot_coll_amt|       tot_cur_bal|       open_acc_6m|       open_act_il|       open_il_12m|       open_il_24m|mths_since_rcnt_il|     total_bal_il|           il_util|       open_rv_12m|       open_rv_24m|       max_bal_bc|          all_util| total_rev_hi_lim|            inq_fi|       total_cu_tl|      inq_last_12m|acc_open_past_24mths|      avg_cur_bal|    bc_open_to_buy|           bc_util|chargeoff_within_12_mths|       delinq_amnt|mo_sin_old_il_acct|mo_sin_old_rev_tl_op|mo_sin_rcnt_rev_tl_op|   mo_sin_rcnt_tl|          mort_acc|mths_since_recent_bc|mths_since_recent_bc_dlq|mths_since_recent_inq|mths_since_recent_revol_delinq|num_accts_ever_120_pd|    num_actv_bc_tl|  num_actv_rev_tl|       num_bc_sats|        num_bc_tl|        num_il_tl|     num_op_rev_tl|    num_rev_accts|num_rev_tl_bal_gt_0|         num_sats|num_tl_120dpd_2m|num_tl_30dpd|  num_tl_90g_dpd_24m|num_tl_op_past_12m|   pct_tl_nvr_dlq|  percent_bc_gt_75|pub_rec_bankruptcies|tax_liens|   tot_hi_cred_lim|total_bal_ex_mort|    total_bc_limit|total_il_high_credit_limit|   revol_bal_joint|sec_app_earliest_cr_line|sec_app_inq_last_6mths|  sec_app_mort_acc|  sec_app_open_acc|sec_app_revol_util|sec_app_open_act_il|sec_app_num_rev_accts|sec_app_chargeoff_within_12_mths|sec_app_collections_12_mths_ex_med|sec_app_mths_since_last_major_derog|hardship_flag|       hardship_type|hardship_reason|hardship_status|deferral_term|hardship_amount|hardship_start_date|hardship_end_date|payment_plan_start_date|hardship_length|hardship_dpd|hardship_loan_status|orig_projected_additional_accrued_interest|hardship_payoff_balance_amount|hardship_last_payment_amount|disbursement_method|debt_settlement_flag|debt_settlement_flag_date|settlement_status|settlement_date|settlement_amount|settlement_percentage|  settlement_term|\n",
            "+-------+--------------------+---------+------------------+------------------+------------------+----------+--------+------------------+------+---------+------------------+----------+--------------+------------------+-------------------+-------+------------------+----------+----+----+--------+--------+--------+----------+------------------+-------------------+----------------+-------------------+----------------------+----------------------+-----------------+-------------------+------------------+----------+------------------+-------------------+------------------+------------------+-----------------+------------------+------------------+-----------------+-------------------+--------------------+-----------------------+------------+-----------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+------------------+------------------+-------------------------+--------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+--------------------+-----------------+------------------+------------------+------------------------+------------------+------------------+--------------------+---------------------+-----------------+------------------+--------------------+------------------------+---------------------+------------------------------+---------------------+------------------+-----------------+------------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------------+----------------+------------+--------------------+------------------+-----------------+------------------+--------------------+---------+------------------+-----------------+------------------+--------------------------+------------------+------------------------+----------------------+------------------+------------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+--------------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+-----------------+\n",
            "|  count|                   2|        0|            128412|            128412|            128412|    128412|  128412|            128412|128412|   128412|            107466|    128412|        128412|            128412|             128412| 128412|            128412|    128412|   0|   0|  128412|  128412|  128412|    128412|            128175|             128412|          128412|             128412|                 56216|                 15450|           128412|             128412|            128412|    128256|            128412|             128412|            128412|            128412|           128412|            128412|            128412|           128412|             128412|              128412|                 128412|      128249|           128412|      123382|            128411|                    128412|                      29180|     128412|          128412|             16782|             16782|                    14848|        128412|            128412|            128412|            128412|            128412|            128412|            128412|            123934|           128412|            108138|            128412|            128412|           128412|            128375|           128412|            128412|            128412|            128412|              128412|           128399|            126721|            126658|                  128412|            128412|            123934|              128412|               128412|           128412|            128412|              126821|                   25169|               112365|                         36782|               128412|            128412|           128412|            128412|           128412|           128412|            128412|           128412|             128412|           128412|          125553|      128412|              128412|            128412|           128412|            126720|              128412|   128412|            128412|           128412|            128412|                    128412|             16782|                   16782|                 16782|             16782|             16782|             16524|              16782|                16782|                           16782|                             16782|                               5154|       128412|                   1|              1|              1|            1|              1|                  1|                1|                      1|              1|           1|                   1|                                         1|                             1|                           1|             128412|              128412|                        5|                5|              5|                5|                    5|                5|\n",
            "|   mean|                NULL|     NULL| 15971.32102139987| 15971.32102139987| 15968.49816614494|      NULL|    NULL|463.26122083604884|  NULL|     NULL|42.333333333333336|      NULL|          NULL|  82797.3278609476|               NULL|   NULL|              NULL|      NULL|NULL|NULL|    NULL|    NULL|    NULL|      NULL|19.933177530719778|0.22783696227766875|            NULL|0.44703766003177275|     36.88033655898676|     86.13016181229773|11.56405164626359|0.12184998286764477|16898.000957854405|      NULL|22.677413325857398|               NULL|14199.242107591357|14196.851785269451|2385.605985664754| 2385.075231364657|1757.9599911223816|627.4848519608684|0.13431548453656983|0.026823661340061675|   0.004828259041211102|        NULL|954.3985597918926|        NULL|              NULL|      0.017957823256393484|          46.55346127484579|        1.0|            NULL|133551.59692229767|19.226602312000985|                     NULL|           0.0|188.30428620378157| 146792.1954334486|0.9395072111640657| 2.760201538796997|0.6890711148490796|1.5726645484845654|20.201518550196074|36272.28023860698| 68.21175719913444|1.1959006946391304|   2.5407827928854|6062.072275176774|54.298812074001944|39382.18396255802|1.1145609444600193|1.5199280441080272|1.8769118150951625|   4.382697878702925|13828.37887366724|15357.302956889545| 50.04870122692595|    0.007086565118524749|0.9677678098620066|123.05692546032566|   173.0636233373828|   15.431634115191727|   8.635400118369|1.3231551568389248|  26.013956679098886|       40.41523302475267|   7.5528322876340495|            37.817274753955736|  0.46155343737345417| 3.659876024047597|5.414127963118712|4.8821293960066035|7.065943992773261|8.288524436968508| 8.199210354172507|12.86670248886397|  5.386342397906738|11.54671681774289|             0.0|         0.0|0.059488209824626985| 2.011642214123291|94.65984331682625| 32.90075599747551| 0.12173317135470205|      0.0|188485.22697255708|53560.97362396038|27439.534163473818|          46821.8001900134| 36642.79668692647|                    NULL|    0.5859849839113336|1.5871767369800978|11.436002860207365| 55.87883079157592| 3.0271123823143844|    12.42390656655941|             0.03616970563699202|               0.06298414968418543|                  38.51590997283663|         NULL|                NULL|           NULL|           NULL|          3.0|         378.39|               NULL|             NULL|                   NULL|            3.0|        22.0|                NULL|                                   1135.17|                      15351.85|                     1045.41|               NULL|                NULL|                     NULL|             NULL|           NULL|           5402.6|               64.024|             15.6|\n",
            "| stddev|                NULL|     NULL|10150.384232741915|10150.384232741915|10152.168969959743|      NULL|    NULL|285.71837061496865|  NULL|     NULL|60.583276020147125|      NULL|          NULL|108298.46579150054|               NULL|   NULL|              NULL|      NULL|NULL|NULL|    NULL|    NULL|    NULL|      NULL|20.143542243475462| 0.7337929617806088|            NULL|  0.734480494601085|     21.81380541370345|    21.880055467858227|5.981598599915456|0.33282509720220677|24082.550912035418|      NULL|12.129215673024731|               NULL|  9764.97412335499|  9766.27022765491| 3500.08015145213|3499.9604828301162|3411.6134041941023|520.6366301069888| 2.3826923116207253|   9.612157146687512|     1.7301882864037452|        NULL|3140.578731390126|        NULL|              NULL|       0.14656909506014967|          21.80171635505549|        0.0|            NULL| 96870.01060785717| 8.141631264595569|                     NULL|           0.0|1569.2900332525958|173872.66638818575|1.1453062243602823|2.9423770941116736| 0.935776078356445|1.5651182649945552|24.869930099899303| 47263.8742683232|23.589461430604807|1.4701234086691273|2.5243260814825255|5932.797468973051| 20.65573636586819|37945.74838043988|1.5014554099558968|2.7123277472263863| 2.296951169566644|  3.2092991618238544|17487.60534123845|19792.599022823757|28.791276443999948|     0.09592353243386022|112.15842117531022| 56.58169736553211|   100.2001985637194|   19.053975885770658|9.573207309980141|1.7131494988244331|   34.30672100720491|        22.3052703951109|   6.0570878383765505|             22.02383518648619|   1.3494118924470198|2.4480789423601856|3.439644201125048|3.2053048133996938|4.517164507177908|7.389194754721825|4.9589047173334375|7.873910626994584| 3.3883802209295357|5.977599473095348|             0.0|         0.0|  0.4106517365944234|1.8805586210680132| 8.98928793444376|34.899646961776014|  0.3325518553629026|      0.0|196553.63659189615|55993.35082192053|26377.282557410348|         49574.91126450033|32525.657340578986|                    NULL|    0.9360527358457791|1.8018781366582577|6.6901187046787625|26.071240784019686| 3.2543184225839386|    8.190066556285275|              0.3477258036611789|               0.36408269614055283|                 23.659435969981708|         NULL|                NULL|           NULL|           NULL|         NULL|           NULL|               NULL|             NULL|                   NULL|           NULL|        NULL|                NULL|                                      NULL|                          NULL|                        NULL|               NULL|                NULL|                     NULL|             NULL|           NULL|2851.191733293291|   2.2500844428598703|3.286335345030997|\n",
            "|    min|Total amount fund...|     NULL|              1000|              1000|             725.0| 36 months|  10.08%|             30.48|     A|       A1| \\tSlot technician|    1 year|           ANY|               0.0|       Not Verified| Dec-18|       Charged Off|         n|NULL|NULL|     car|Business|   010xx|        AK|               0.0|                  0|          Apr-00|                  0|                     0|                     5|                0|                  0|                 0|        0%|                 2|                  f|               0.0|               0.0|              0.0|               0.0|               0.0|              0.0|                0.0|                 0.0|                    0.0|      Dec-18|              0.0|      Apr-19|            Aug-18|                         0|                          0|          1|      Individual|            9000.0|               0.0|             Not Verified|             0|                 0|                 0|                 0|                 0|                 0|                 0|                 0|                0|                 0|                 0|                 0|                0|                 0|                0|                 0|                 0|                 0|                   0|                0|                 0|               0.0|                       0|                 0|                 0|                   3|                    0|                0|                 0|                   0|                       1|                    0|                             1|                    0|                 0|                0|                 0|                0|                0|                 0|                2|                  0|                0|               0|           0|                   0|                 0|              0.0|               0.0|                   0|        0|                 0|                0|                 0|                         0|                 0|                  Apr-00|                     0|                 0|                 0|               0.0|                  0|                    0|                               0|                                 0|                                  0|            N|INTEREST ONLY-3 M...|   UNEMPLOYMENT|         ACTIVE|            3|         378.39|             Feb-19|           Apr-19|                 Feb-19|              3|          22|   Late (16-30 days)|                                   1135.17|                      15351.85|                     1045.41|               Cash|                   N|                   Mar-19|           ACTIVE|         Feb-19|             2576|                 60.0|               12|\n",
            "|    max|Total amount fund...|     NULL|             40000|             40000|           40000.0| 60 months|   8.81%|           1618.24|     G|       G5|       youthworker|       n/a|          RENT|         9757200.0|           Verified| Oct-18|Late (31-120 days)|         y|NULL|NULL|vacation|Vacation|   999xx|        WY|             999.0|                 24|          Sep-99|                  5|                   160|                   119|               94|                  6|           2358150|    99.90%|               160|                  w|           40000.0|           40000.0|      43313.65022|          43313.65|           40000.0|          4981.05|              141.6|             3444.48|               620.0064|      Oct-18|         41253.54|      May-19|            Sep-18|                         8|                        162|          1|       Joint App|         6282000.0|             39.99|                 Verified|             0|            208593|           9971659|                13|                56|                 6|                19|               505|          1837038|               428|                22|                40|           338224|               188|          1596201|                29|                56|                51|                  43|           623229|            605996|             183.8|                       7|             31593|               827|                 826|                  382|              382|                87|                 640|                     152|                   25|                           160|                   31|                48|               59|                64|               69|              130|                69|              127|                 37|               94|               0|           0|                  23|                24|            100.0|             100.0|                   6|        0|           9999999|          2622906|            666200|                   2118996|           1110019|                  Sep-99|                     6|                15|                67|             170.1|                 34|                   95|                              21|                                15|                                153|            Y|INTEREST ONLY-3 M...|   UNEMPLOYMENT|         ACTIVE|            3|         378.39|             Feb-19|           Apr-19|                 Feb-19|              3|          22|   Late (16-30 days)|                                   1135.17|                      15351.85|                     1045.41|          DirectPay|                   Y|                   Mar-19|           BROKEN|         Mar-19|            10119|                65.12|               18|\n",
            "+-------+--------------------+---------+------------------+------------------+------------------+----------+--------+------------------+------+---------+------------------+----------+--------------+------------------+-------------------+-------+------------------+----------+----+----+--------+--------+--------+----------+------------------+-------------------+----------------+-------------------+----------------------+----------------------+-----------------+-------------------+------------------+----------+------------------+-------------------+------------------+------------------+-----------------+------------------+------------------+-----------------+-------------------+--------------------+-----------------------+------------+-----------------+------------+------------------+--------------------------+---------------------------+-----------+----------------+------------------+------------------+-------------------------+--------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+------------------+--------------------+-----------------+------------------+------------------+------------------------+------------------+------------------+--------------------+---------------------+-----------------+------------------+--------------------+------------------------+---------------------+------------------------------+---------------------+------------------+-----------------+------------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------------+----------------+------------+--------------------+------------------+-----------------+------------------+--------------------+---------+------------------+-----------------+------------------+--------------------------+------------------+------------------------+----------------------+------------------+------------------+------------------+-------------------+---------------------+--------------------------------+----------------------------------+-----------------------------------+-------------+--------------------+---------------+---------------+-------------+---------------+-------------------+-----------------+-----------------------+---------------+------------+--------------------+------------------------------------------+------------------------------+----------------------------+-------------------+--------------------+-------------------------+-----------------+---------------+-----------------+---------------------+-----------------+\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "SEwRCFPgHJOG"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "qedw7bN5HKt7"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "df_sel=df.select(\"term\",\"home_ownership\",\"grade\",\"purpose\",\"int_rate\",\"loan_amnt\",\"emp_length\",\"annual_inc\",\"loan_amnt\",\"purpose\",\"grade\")\n",
        "df_sel.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "pagyqxYgpdeP",
        "outputId": "a51f674e-dab6-4c98-ed61-2cc5d92adcc0"
      },
      "execution_count": 31,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+----------+--------------+-----+------------------+--------+---------+----------+----------+---------+------------------+-----+\n",
            "|      term|home_ownership|grade|           purpose|int_rate|loan_amnt|emp_length|annual_inc|loan_amnt|           purpose|grade|\n",
            "+----------+--------------+-----+------------------+--------+---------+----------+----------+---------+------------------+-----+\n",
            "| 36 months|      MORTGAGE|    B|debt_consolidation|  10.33%|    10000|  < 1 year|  280000.0|    10000|debt_consolidation|    B|\n",
            "| 36 months|          RENT|    C|debt_consolidation|  13.56%|     2500| 10+ years|   55000.0|     2500|debt_consolidation|    C|\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  13.56%|    12000|  < 1 year|   40000.0|    12000|debt_consolidation|    C|\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  14.47%|    15000|       n/a|   30000.0|    15000|debt_consolidation|    C|\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  17.97%|    16000|   5 years|   51000.0|    16000|debt_consolidation|    D|\n",
            "| 36 months|          RENT|    E|       credit_card|  23.40%|     9600|   9 years|   65000.0|     9600|       credit_card|    E|\n",
            "| 36 months|          RENT|    E|debt_consolidation|  23.40%|     4000|   3 years|   90000.0|     4000|debt_consolidation|    E|\n",
            "| 36 months|      MORTGAGE|    D|               car|  20.89%|     3500| 10+ years|   40000.0|     3500|               car|    D|\n",
            "| 36 months|      MORTGAGE|    B|  home_improvement|  12.98%|     9600|       n/a|   35704.0|     9600|  home_improvement|    B|\n",
            "| 36 months|           OWN|    E|debt_consolidation|  23.40%|     8000| 10+ years|   43000.0|     8000|debt_consolidation|    E|\n",
            "| 60 months|          RENT|    E|       credit_card|  26.31%|    16000|  < 1 year|   33000.0|    16000|       credit_card|    E|\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  18.94%|    30000| 10+ years|   90000.0|    30000|debt_consolidation|    D|\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  19.92%|    10000| 10+ years|   80000.0|    10000|debt_consolidation|    D|\n",
            "| 36 months|      MORTGAGE|    D|debt_consolidation|  17.97%|     5000|   6 years|   59280.0|     5000|debt_consolidation|    D|\n",
            "| 60 months|          RENT|    D|debt_consolidation|  20.89%|    23000|   5 years|   68107.0|    23000|debt_consolidation|    D|\n",
            "| 60 months|      MORTGAGE|    B|       credit_card|  11.80%|    32075| 10+ years|  150000.0|    32075|       credit_card|    B|\n",
            "| 36 months|      MORTGAGE|    E|             other|  23.40%|    13000|   2 years|   90000.0|    13000|             other|    E|\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  15.02%|    35000| 10+ years|  290000.0|    35000|debt_consolidation|    C|\n",
            "| 60 months|      MORTGAGE|    B|debt_consolidation|  11.31%|    40000|  < 1 year|  136000.0|    40000|debt_consolidation|    B|\n",
            "| 36 months|      MORTGAGE|    B|       credit_card|  10.33%|     8000|   6 years|   38000.0|     8000|       credit_card|    B|\n",
            "+----------+--------------+-----+------------------+--------+---------+----------+----------+---------+------------------+-----+\n",
            "only showing top 20 rows\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_sel.describe().show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "L6cwig8yq9L-",
        "outputId": "8706163f-87b7-4751-9593-dc4d8483189a"
      },
      "execution_count": 57,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+-------+----------+--------------+------+--------+--------+------------------+\n",
            "|summary|      term|home_ownership| grade| purpose|int_rate|         loan_amnt|\n",
            "+-------+----------+--------------+------+--------+--------+------------------+\n",
            "|  count|    128412|        128412|128412|  128412|  128412|            128412|\n",
            "|   mean|      NULL|          NULL|  NULL|    NULL|    NULL| 15971.32102139987|\n",
            "| stddev|      NULL|          NULL|  NULL|    NULL|    NULL|10150.384232741915|\n",
            "|    min| 36 months|           ANY|     A|     car|  10.08%|              1000|\n",
            "|    max| 60 months|          RENT|     G|vacation|   8.81%|             40000|\n",
            "+-------+----------+--------------+------+--------+--------+------------------+\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from pyspark.sql.functions import regexp_replace, regexp_extract\n",
        "from pyspark.sql.functions import col\n"
      ],
      "metadata": {
        "id": "tgin9dO-Dwxj"
      },
      "execution_count": 17,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "regex_string=\"\\\\d+\"\n",
        "df_sel.select(regexp_extract(col(\"emp_length\"),regex_string,0).alias(\"emp_length_cleaned\"),col(\"emp_length\")).show(30)\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "wHYAXkgasU6X",
        "outputId": "1c048d2c-b78c-4b83-9d59-612547e07aab"
      },
      "execution_count": 23,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+------------------+----------+\n",
            "|emp_length_cleaned|emp_length|\n",
            "+------------------+----------+\n",
            "|                 1|  < 1 year|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                  |       n/a|\n",
            "|                 5|   5 years|\n",
            "|                 9|   9 years|\n",
            "|                 3|   3 years|\n",
            "|                10| 10+ years|\n",
            "|                  |       n/a|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                10| 10+ years|\n",
            "|                10| 10+ years|\n",
            "|                 6|   6 years|\n",
            "|                 5|   5 years|\n",
            "|                10| 10+ years|\n",
            "|                 2|   2 years|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                 6|   6 years|\n",
            "|                10| 10+ years|\n",
            "|                 5|   5 years|\n",
            "|                10| 10+ years|\n",
            "|                 3|   3 years|\n",
            "|                  |       n/a|\n",
            "|                 5|   5 years|\n",
            "|                 1|    1 year|\n",
            "|                 1|    1 year|\n",
            "|                  |       n/a|\n",
            "|                10| 10+ years|\n",
            "+------------------+----------+\n",
            "only showing top 30 rows\n",
            "\n",
            "+------------------+----------+\n",
            "|emp_length_cleaned|emp_length|\n",
            "+------------------+----------+\n",
            "|                 1|  < 1 year|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                  |       n/a|\n",
            "|                 5|   5 years|\n",
            "|                 9|   9 years|\n",
            "|                 3|   3 years|\n",
            "|                10| 10+ years|\n",
            "|                  |       n/a|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                10| 10+ years|\n",
            "|                10| 10+ years|\n",
            "|                 6|   6 years|\n",
            "|                 5|   5 years|\n",
            "|                10| 10+ years|\n",
            "|                 2|   2 years|\n",
            "|                10| 10+ years|\n",
            "|                 1|  < 1 year|\n",
            "|                 6|   6 years|\n",
            "|                10| 10+ years|\n",
            "|                 5|   5 years|\n",
            "|                10| 10+ years|\n",
            "|                 3|   3 years|\n",
            "|                  |       n/a|\n",
            "|                 5|   5 years|\n",
            "|                 1|    1 year|\n",
            "|                 1|    1 year|\n",
            "|                  |       n/a|\n",
            "|                10| 10+ years|\n",
            "+------------------+----------+\n",
            "only showing top 30 rows\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_sel=df_sel.withColumn(\"emp_length_cleaned\",regexp_extract(col(\"emp_length\"),regex_string,0))\n",
        "df_sel=df_sel.withColumn(\"term_cleaned\",regexp_replace(col(\"term\"),\"months\",\" \"))\n",
        "df_sel.show()\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "7I1aynAyHM1S",
        "outputId": "cdab7989-5fa0-4732-931b-2fb7ab65a80d"
      },
      "execution_count": 27,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+----------+--------------+-----+------------------+--------+---------+----------+------------------+------------+\n",
            "|      term|home_ownership|grade|           purpose|int_rate|loan_amnt|emp_length|emp_length_cleaned|term_cleaned|\n",
            "+----------+--------------+-----+------------------+--------+---------+----------+------------------+------------+\n",
            "| 36 months|      MORTGAGE|    B|debt_consolidation|  10.33%|    10000|  < 1 year|                 1|        36  |\n",
            "| 36 months|          RENT|    C|debt_consolidation|  13.56%|     2500| 10+ years|                10|        36  |\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  13.56%|    12000|  < 1 year|                 1|        60  |\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  14.47%|    15000|       n/a|                  |        60  |\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  17.97%|    16000|   5 years|                 5|        60  |\n",
            "| 36 months|          RENT|    E|       credit_card|  23.40%|     9600|   9 years|                 9|        36  |\n",
            "| 36 months|          RENT|    E|debt_consolidation|  23.40%|     4000|   3 years|                 3|        36  |\n",
            "| 36 months|      MORTGAGE|    D|               car|  20.89%|     3500| 10+ years|                10|        36  |\n",
            "| 36 months|      MORTGAGE|    B|  home_improvement|  12.98%|     9600|       n/a|                  |        36  |\n",
            "| 36 months|           OWN|    E|debt_consolidation|  23.40%|     8000| 10+ years|                10|        36  |\n",
            "| 60 months|          RENT|    E|       credit_card|  26.31%|    16000|  < 1 year|                 1|        60  |\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  18.94%|    30000| 10+ years|                10|        60  |\n",
            "| 60 months|      MORTGAGE|    D|debt_consolidation|  19.92%|    10000| 10+ years|                10|        60  |\n",
            "| 36 months|      MORTGAGE|    D|debt_consolidation|  17.97%|     5000|   6 years|                 6|        36  |\n",
            "| 60 months|          RENT|    D|debt_consolidation|  20.89%|    23000|   5 years|                 5|        60  |\n",
            "| 60 months|      MORTGAGE|    B|       credit_card|  11.80%|    32075| 10+ years|                10|        60  |\n",
            "| 36 months|      MORTGAGE|    E|             other|  23.40%|    13000|   2 years|                 2|        36  |\n",
            "| 60 months|      MORTGAGE|    C|debt_consolidation|  15.02%|    35000| 10+ years|                10|        60  |\n",
            "| 60 months|      MORTGAGE|    B|debt_consolidation|  11.31%|    40000|  < 1 year|                 1|        60  |\n",
            "| 36 months|      MORTGAGE|    B|       credit_card|  10.33%|     8000|   6 years|                 6|        36  |\n",
            "+----------+--------------+-----+------------------+--------+---------+----------+------------------+------------+\n",
            "only showing top 20 rows\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_sel.stat.cov('annual_inc','loan_amnt')\n",
        "df_sel.stat.corr('annual_inc','loan_amnt')"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Y5--Qb4lLk4H",
        "outputId": "bfc3648d-7f04-468e-bb93-7cb71a4b1ca3"
      },
      "execution_count": 30,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "0.33932856743552814"
            ]
          },
          "metadata": {},
          "execution_count": 30
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "freq=df_sel.stat.freqItems([\"grade\",\"purpose\"],0.3)\n",
        "freq.show()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "sR1AWomzMnv3",
        "outputId": "2037f6b8-8f81-49ec-8e8c-6163820dda01"
      },
      "execution_count": 35,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "+---------------+--------------------+\n",
            "|grade_freqItems|   purpose_freqItems|\n",
            "+---------------+--------------------+\n",
            "|      [A, B, C]|[debt_consolidati...|\n",
            "+---------------+--------------------+\n",
            "\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "authorship_tag": "ABX9TyN3ax9fcvqI5vY+4emjWpWq",
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}